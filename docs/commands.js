!function(e){function n(n){for(var r,c,s=n[0],u=n[1],a=n[2],d=0,f=[];d<s.length;d++)c=s[d],o[c]&&f.push(o[c][0]),o[c]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(n);f.length;)f.shift()();return i.push.apply(i,a||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],r=!0,s=1;s<t.length;s++){var u=t[s];0!==o[u]&&(r=!1)}r&&(i.splice(n--,1),e=c(c.s=t[0]))}return e}var r={},o={3:0},i=[];function c(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.m=e,c.c=r,c.d=function(e,n,t){c.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,n){if(1&n&&(e=c(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)c.d(t,r,function(n){return e[n]}.bind(null,r));return t},c.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(n,"a",n),n},c.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},c.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=n,s=s.slice();for(var a=0;a<s.length;a++)n(s[a]);var l=u;i.push([596,0,1]),t()}({57:function(e,n,t){"use strict";(function(e){var r=t(93),o=t.n(r),i=t(94),c=t.n(i),s=t(95),u=t.n(s),a=t(96),l=t.n(a),d=t(97),f=t.n(d),p=t(58),h=function(n,t,r,o){return new(r||(r=e))(function(e,i){function c(e){try{u(o.next(e))}catch(e){i(e)}}function s(e){try{u(o.throw(e))}catch(e){i(e)}}function u(n){n.done?e(n.value):new r(function(e){e(n.value)}).then(c,s)}u((o=o.apply(n,t||[])).next())})},g=function(e,n){var t,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},v={enableStyler:!0,inlineStyle:!0,enablePrettier:!0,proseWrap:!1},b=function(e){return e.replace(/(?:\r\n|\r|\n)/g,"\n").replace(/\xA0/g," ")},y=function(e,n){return h(void 0,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return console.debug("Geting point paragraph... ",n),e.paragraphs.load("items"),[4,e.paragraphs.context.sync()];case 1:return t.sent(),console.debug("Got paragraph: ",e.paragraphs.items[n.line-1]),[2,e.paragraphs.items[n.line-1]]}})})},m=function(e,n,t){return h(void 0,void 0,void 0,function(){var r,o;return g(this,function(i){switch(i.label){case 0:return console.debug("Getting point cursor... ",n),[4,y(e,n)];case 1:return r=i.sent(),(o=r.split([""])).load("items"),[4,o.context.sync()];case 2:return i.sent(),console.debug("Got paragraph char cursors: ",o),[2,t.isEnd?o.items[n.column-2]:o.items[n.column-1]]}})})},w=function(e,n){return h(void 0,void 0,void 0,function(){var t,r,o,i,c;return g(this,function(s){switch(s.label){case 0:return[4,y(e,n.position.start)];case 1:return t=s.sent(),(r=t.split([""])).load("items"),[4,r.context.sync()];case 2:return s.sent(),o=r.items[n.position.start.column-1],n.position.start.line!=n.position.end.line?[3,3]:(c=r.items[n.position.end.column-2],[3,5]);case 3:return[4,m(e,n.position.end,{isEnd:!0})];case 4:c=s.sent(),s.label=5;case 5:return i=c,[2,o.expandTo(i.getRange(Word.RangeLocation.after))]}})})},x=function(e,n){return h(void 0,void 0,void 0,function(){var t,r;return g(this,function(o){switch(o.label){case 0:return[4,n(e)];case 1:if(o.sent(),!(t=e).children)return[3,5];r=0,o.label=2;case 2:return r<t.children.length?[4,x(t.children[r],n)]:[3,5];case 3:o.sent(),o.label=4;case 4:return r++,[3,2];case 5:return[2]}})})},S=function(e){var n=this,t=e.range,r=!!e.inlineStyle;return this.Compiler=function(e){return console.debug("Compiler Tree:",e),""},function(e,o){return h(n,void 0,void 0,function(){var n=this;return g(this,function(o){switch(o.label){case 0:return console.debug("Tree: ",e),t.paragraphs.load(),[4,t.context.sync()];case 1:return o.sent(),[4,x(e,function(e){return h(n,void 0,void 0,function(){var n,o,i,c;return g(this,function(s){switch(s.label){case 0:switch(console.debug("Node: ",e),e.type){case"yaml":return[3,1];case"heading":return[3,5];case"strong":return[3,7]}return[3,9];case 1:return[4,w(t,e)];case 2:return(c=s.sent()).font.color="darkblue",[4,c.context.sync()];case 3:return s.sent(),(n=c.search("title:").getFirst().paragraphs.getFirst()).styleBuiltIn=Word.Style.title,[4,n.context.sync()];case 4:return s.sent(),[3,9];case 5:return o=e,i=[Word.Style.title,Word.Style.heading1,Word.Style.heading2,Word.Style.heading3,Word.Style.heading4,Word.Style.heading5,Word.Style.heading6,Word.Style.heading7,Word.Style.heading8,Word.Style.heading9],[4,y(t,e.position.start)];case 6:return s.sent().styleBuiltIn=i[o.depth],[3,9];case 7:return r?[4,w(t,e)]:[3,9];case 8:return(c=s.sent()).styleBuiltIn=Word.Style.strong,c.font.color="darkblue",[3,9];case 9:return[2]}})})})];case 2:return o.sent(),[2,e]}})})}},W=function(n,t){return void 0===t&&(t={}),h(void 0,void 0,void 0,function(){var r=this;return g(this,function(i){switch(i.label){case 0:return[4,Word.run(function(){return h(r,void 0,void 0,function(){var r;return g(this,function(i){switch(i.label){case 0:return console.debug("Parsing markdown document..."),n.load(),[4,n.context.sync()];case 1:return i.sent(),r=b(n.text),[4,new e(function(e,i){o()().use(u.a).use(c.a,["yaml","toml"]).use(S,{range:n,inlineStyle:t.inlineStyle}).process(r,function(n,t){n&&i(n),e("")})})];case 2:return i.sent(),console.info("Walking through done."),[4,n.context.sync()];case 3:return i.sent(),[2]}})})})];case 1:return i.sent(),console.info("Styler process done."),[2]}})})},k=function(e,n){return void 0===n&&(n={}),h(void 0,void 0,void 0,function(){var t=this;return g(this,function(r){switch(r.label){case 0:return[4,Word.run(function(){return h(t,void 0,void 0,function(){var t,r,o,i,c,s,u,a,d;return g(this,function(h){switch(h.label){case 0:return console.debug("Fetching document content..."),e.load(),[4,e.context.sync()];case 1:return h.sent(),""==(t=b(e.text))?(console.error("No text is selected"),[2]):(o=(r=console).info,i=["Original Text: ",t],[4,Object(p.a)(t)]);case 2:return o.apply(r,i.concat([h.sent()])),console.debug("Prettifying markdown document..."),c=l.a.format(t,{parser:"markdown",plugins:[f.a],proseWrap:n.proseWrap?"always":"never"}),u=(s=console).info,a=["Pretty Text: ",c],[4,Object(p.a)(c)];case 3:return u.apply(s,a.concat([h.sent()])),d=c,t.startsWith("\n")&&!d.startsWith("\n")&&(d="\n"+d),!t.endsWith("\n")&&d.endsWith("\n")&&(d=d.slice(0,-1)),console.debug("Fixed Text: ",d),console.debug("Replacing prettier document..."),e.insertText(d.replace(/[ ]{2,}/g,function(e){return"Â ".repeat(e.length)}),Word.InsertLocation.replace),[4,e.context.sync()];case 4:return h.sent(),[2]}})})})];case 1:return r.sent(),console.info("Prettier process done."),[2]}})})},O=function(n){return h(void 0,void 0,void 0,function(){var t,r=this;return g(this,function(o){switch(o.label){case 0:return[4,h(void 0,void 0,void 0,function(){var n,t;return g(this,function(r){switch(r.label){case 0:return console.debug("Loading addin settings..."),[4,new e(function(e,n){Office.context.document.settings.refreshAsync(function(t){console.debug("Loaded addin settings result: ",t),t.status!==Office.AsyncResultStatus.Succeeded&&n(t.error),e()})})];case 1:return r.sent(),n=Office.context.document.settings.get("settings"),t=Office.context.document.settings.get("profile"),console.info("Loaded Settings: ",n,"Profile: ",t),n?[2,n]:(Office.context.document.settings.set("settings",v),[2,v])}})})];case 1:return t=o.sent(),[4,Word.run(function(){return h(r,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return console.debug("Reseting style ..."),n.styleBuiltIn=Word.Style.normal,[4,n.context.sync()];case 1:return e.sent(),[2]}})})})];case 2:return o.sent(),t.enablePrettier?[4,k(n,{proseWrap:t.proseWrap})]:[3,4];case 3:o.sent(),o.label=4;case 4:return t.enableStyler?[4,W(n,{inlineStyle:t.inlineStyle})]:[3,6];case 5:o.sent(),o.label=6;case 6:return console.info("All processes done."),[2]}})})};n.a={ProcessSelection:function(){return h(void 0,void 0,void 0,function(){var e,n,t=this;return g(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=void 0,[4,Word.run(function(n){return h(t,void 0,void 0,function(){var t;return g(this,function(r){switch(r.label){case 0:return console.debug("Getting selection range..."),o=n.document.getSelection(),i=o.paragraphs.getFirst().getRange(Word.RangeLocation.start),c=o.paragraphs.getLast().getRange(Word.RangeLocation.end),t=o.expandTo(i).expandTo(c),e=t,n.trackedObjects.add(e),[4,n.sync()];case 1:return r.sent(),[2]}var o,i,c})})})];case 1:return r.sent(),[4,O(e)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.error(n),[3,4];case 4:return[2]}})})},ProcessDocument:function(){return h(void 0,void 0,void 0,function(){var e,n,t=this;return g(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=void 0,[4,Word.run(function(n){return h(t,void 0,void 0,function(){var t;return g(this,function(r){switch(r.label){case 0:return console.debug("Getting document range..."),t=n.document.body.getRange(),e=t,n.trackedObjects.add(e),[4,n.sync()];case 1:return r.sent(),[2]}})})})];case 1:return r.sent(),[4,O(e)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.error(n),[3,4];case 4:return[2]}})})}}}).call(this,t(27).Promise)},58:function(e,n,t){"use strict";(function(e){t.d(n,"a",function(){return i});var r=function(n,t,r,o){return new(r||(r=e))(function(e,i){function c(e){try{u(o.next(e))}catch(e){i(e)}}function s(e){try{u(o.throw(e))}catch(e){i(e)}}function u(n){n.done?e(n.value):new r(function(e){e(n.value)}).then(c,s)}u((o=o.apply(n,t||[])).next())})},o=function(e,n){var t,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=function(e){return r(void 0,void 0,void 0,function(){return o(this,function(n){return[2,e.split("").map(function(e){return e.charCodeAt(0)})]})})}}).call(this,t(27).Promise)},596:function(e,n,t){"use strict";t.r(n),function(e){t(322),t(362);var n=t(57);Office.onReady(function(){});var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:void 0;r.onClickRemarkSelection=function(e){console.debug("[Ribbon] Remarking selection...",e),n.a.ProcessSelection().finally(function(){e.completed()})},r.onClickRemarkDocument=function(e){console.debug("[Ribbon] Remarking document...",e),n.a.ProcessDocument().finally(function(){e.completed()})}}.call(this,t(50))}});
//# sourceMappingURL=commands.js.map