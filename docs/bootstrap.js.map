{"version":3,"sources":["webpack:///./src/taskpane/components/App.tsx","webpack:///./src/taskpane/components/HeroList.tsx","webpack:///./src/taskpane/components/Progress.tsx","webpack:///./src/README.md","webpack:///./src/core/debug.ts","webpack:///./src/taskpane/bootstrap.tsx","webpack:///./src/core/styler.ts","webpack:///./src/core/utils.ts"],"names":["MessageRecord","Object","immutable__WEBPACK_IMPORTED_MODULE_0__","id","content","type","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_2__","info","display","isDismissable","ProfileRecord","showGetStarted","showMessages","SettingsRecord","enableStyler","inlineStyle","enablePrettier","proseWrap","ButtonStyle","width","ElementContainer","_super","__extends","prototype","render","react__WEBPACK_IMPORTED_MODULE_1__","className","style","justifyContent","padding","this","props","children","CongratsText","App","context","_this","call","clickDevButton","__awaiter","console","log","state","Word","run","document","body","insertText","InsertLocation","replace","font","color","sync","_a","sent","insertReadme","FilteredReadme","raw_loader_README_md__WEBPACK_IMPORTED_MODULE_13__","start","paragraphs","load","CongratsParagraph","items","insertParagraph","after","bold","error","setupTheme","remarkSelection","_core_styler__WEBPACK_IMPORTED_MODULE_12__","ProcessSelection","remarkDocument","ProcessDocument","saveSettings","settings","toJS","profile","Office","set","saveAsync","result","resetSettings","setState","dismissGetStarted","insert","dismissMessage","messageId","get","mergeSettings","partialSettings","merge","messages","componentDidMount","refreshAsync","warning","success","isOfficeInitialized","_HeroList__WEBPACK_IMPORTED_MODULE_10__","message","dir","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_3__","map","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_4__","key","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_5__","messageBarType","onDismiss","undefined","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_6__","_core_debug__WEBPACK_IMPORTED_MODULE_14__","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_7__","iconProps","iconName","onClick","ref","span","GetStartedSpan","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_8__","target","primaryButtonProps","secondaryButtonProps","headline","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_9__","checked","label","inlineLabel","onChange","_","_Progress__WEBPACK_IMPORTED_MODULE_11__","title","logo","HeroList","listItems","item","index","react__WEBPACK_IMPORTED_MODULE_0__","icon","primaryText","Progress","height","src","alt","office_ui_fabric_react__WEBPACK_IMPORTED_MODULE_1__","large","__webpack_exports__","DEBUG","office_ui_fabric_react_lib_Icons__WEBPACK_IMPORTED_MODULE_1__","Bootstrap","Component","app","__assign","_uifabric_fluent_theme__WEBPACK_IMPORTED_MODULE_3__","defaultProps","_components_App__WEBPACK_IMPORTED_MODULE_4__","DEFAULT_SETTINGS","getCleanText","str","getPointParagraph","range","point","line","getPointCursur","options","pointParagraph","charRanges","split","isEnd","column","getNodeRange","node","position","startParagraph","_b","startCharRanges","startCursor","end","endCursor","expandTo","getRange","RangeLocation","UnistDFS","visitor","extendedNode","length","RemarkWord","Compiler","tree","nodeRange","titleParagraph","search","getFirst","styleBuiltIn","Style","nodeHeading","WordHeadingStyles","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","depth","strong","ProcessStyler","remarkText","text","Promise","resolve","reject","unified__WEBPACK_IMPORTED_MODULE_0___default","use","remark_parse__WEBPACK_IMPORTED_MODULE_2___default","a","remark_frontmatter__WEBPACK_IMPORTED_MODULE_1___default","process","ProcessPrettier","_g","originalText","_utils__WEBPACK_IMPORTED_MODULE_5__","apply","_c","concat","prettyText","prettier_standalone__WEBPACK_IMPORTED_MODULE_3___default","format","parser","plugins","prettier_parser_markdown__WEBPACK_IMPORTED_MODULE_4___default","_e","_d","_f","fixedText","startsWith","endsWith","slice","match","repeat","ProcessRange","status","AsyncResultStatus","Succeeded","normal","remarkRange_1","getSelection","getLast","inputRange","trackedObjects","add","error_1","remarkRange_2","error_2","hex","__generator","ch","charCodeAt"],"mappings":"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","file":"bootstrap.js","sourcesContent":["import { Record, List, Map } from \"immutable\"\nimport * as React from \"react\"\nimport * as Fabric from \"office-ui-fabric-react\"\nimport HeroList from \"./HeroList\"\nimport Progress from \"./Progress\"\nimport Styler from \"../../core/styler\"\nimport ReadmeMarkdown from \"raw-loader!../../README.md\"\nimport DEBUG from \"../../core/debug\"\n\n// Types\n\nexport interface AppPropsType {\n  title: string\n  isOfficeInitialized: boolean\n}\ninterface MessageType {\n  id: string\n  content: any\n  type: Fabric.MessageBarType\n  display: boolean\n  isDismissable: boolean\n}\nconst MessageRecord = Record<MessageType>({\n  id: \"\",\n  content: \"\",\n  type: Fabric.MessageBarType.info,\n  display: true,\n  isDismissable: true,\n})\ninterface ProfileType {\n  showGetStarted: boolean\n  showMessages: Map<string, boolean>\n}\nconst ProfileRecord = Record<ProfileType>({\n  showGetStarted: true,\n  showMessages: Map<string, boolean>(),\n})\ninterface SettingsType {\n  enableStyler: boolean\n  inlineStyle: boolean\n  enablePrettier: boolean\n  proseWrap: boolean\n}\nconst SettingsRecord = Record<SettingsType>({\n  enableStyler: true,\n  inlineStyle: true,\n  enablePrettier: true,\n  proseWrap: false,\n})\nexport interface AppStateType {\n  settings: Record<SettingsType>\n  profile: Record<ProfileType>\n  messages: List<Record<MessageType>>\n}\n\n// Styles\n\nconst ButtonStyle: React.CSSProperties = {\n  width: \"100%\",\n}\nclass ElementContainer extends React.Component {\n  render() {\n    return (\n      <div\n        className=\"ms-Grid-col ms-sm12 ms-md6 ms-lg3\"\n        style={{\n          justifyContent: \"center\",\n          display: \"flex\",\n          padding: \"5px 5px 0 0\",\n        }}\n      >\n        <div style={{ width: \"200px\" }}>{this.props.children}</div>\n      </div>\n    )\n  }\n}\n\n// Data\n\nconst CongratsText = `<!-- Congratulations! Your team's life becomes much easier! Now, click on \"Remark Document\" to continue reading. -->`\n\n// Component\n\nexport default class App extends React.Component<AppPropsType, AppStateType> {\n  GetStartedSpan: HTMLSpanElement\n\n  constructor(props, context) {\n    super(props, context)\n    this.state = {\n      settings: SettingsRecord(),\n      profile: ProfileRecord(),\n      messages: List<Record<MessageType>>(),\n    }\n    console.info(\"Initial props: \", this.props, \"Initial state: \", this.state)\n  }\n\n  componentDidMount() {\n    Office.context.document.settings.refreshAsync(result => {\n      try {\n        console.debug(\"Loaded addin settings: \", result)\n        const settings = Office.context.document.settings.get(\"settings\")\n        const profile = Office.context.document.settings.get(\"profile\")\n        console.info(\"Loaded Settings: \", settings, \"Profile: \", profile)\n        profile.showMessages = Map(profile.showMessages)\n        this.setState(\n          {\n            settings: SettingsRecord(settings),\n            profile: ProfileRecord(profile),\n          },\n          () => {\n            console.debug(\"Loaded state: \", this.state)\n          }\n        )\n      } catch (error) {\n        console.error(error)\n      }\n    })\n\n    this.setState(() => {\n      return {\n        messages: List<Record<MessageType>>([\n          MessageRecord({\n            id: \"VersionHistory\",\n            content:\n              'Use OneDrive \"Version History\" to get your work back in case anything is missing',\n            type: Fabric.MessageBarType.error,\n            display: true,\n            isDismissable: true,\n          }),\n          MessageRecord({\n            id: \"DesktopSupport\",\n            content:\n              \"Known issue: Word Desktop is not supported for now as it's using IE as internal javascript engine\",\n            type: Fabric.MessageBarType.warning,\n            display: true,\n            isDismissable: true,\n          }),\n          MessageRecord({\n            id: \"Whitespace\",\n            content:\n              \"Known issue: Due to MS Word implementation, the space (ascii:32) might be replaced by a nb-space (nbsp, ascii:160) by accident. Use caution when you copy your content into clipboard\",\n            type: Fabric.MessageBarType.warning,\n            display: true,\n            isDismissable: true,\n          }),\n          MessageRecord({\n            id: \"DocumentSettings\",\n            content: \"Add-in settings are stored per documend\",\n            type: Fabric.MessageBarType.info,\n            display: true,\n            isDismissable: true,\n          }),\n          MessageRecord({\n            id: \"FindReadme\",\n            content: \"Above messages can be found in Readme\",\n            type: Fabric.MessageBarType.success,\n            display: true,\n            isDismissable: true,\n          }),\n        ]),\n      }\n    })\n  }\n\n  clickDevButton = async () => {\n    console.log(\"State: \", this.state)\n    const devMarkdown = `\nIt's a **strong** word\n`\n    return Word.run(async context => {\n      const paragraph = context.document.body.insertText(\n        devMarkdown,\n        Word.InsertLocation.replace\n      )\n      paragraph.font.color = \"blue\"\n      await context.sync()\n    })\n  }\n\n  insertReadme = async () => {\n    console.debug(\"Inserting readme...\")\n    let FilteredReadme = ReadmeMarkdown\n    FilteredReadme = FilteredReadme.replace(\n      /INSTALL SECTION BEGIN(.|\\n)*INSTALL SECTION END/gm,\n      \"\"\n    )\n    FilteredReadme = FilteredReadme.replace(/<!--.*-->\\n/g, \"\")\n    try {\n      return Word.run(async context => {\n        context.document.body.insertText(\n          FilteredReadme,\n          Word.InsertLocation.start\n        )\n        await context.sync()\n        context.document.body.paragraphs.load()\n        await context.sync()\n        const CongratsParagraph = context.document.body.paragraphs.items[3].insertParagraph(\n          CongratsText,\n          Word.InsertLocation.after\n        )\n        CongratsParagraph.font.color = \"red\"\n        CongratsParagraph.font.bold = true\n        await context.sync()\n      })\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  setupTheme = async () => {\n    console.debug(\"Setting up document theme...\")\n    console.error(\"Not Implemented\")\n  }\n\n  remarkSelection = async () => {\n    console.debug(\"Remarking selection...\")\n    await Styler.ProcessSelection()\n  }\n\n  remarkDocument = async () => {\n    console.debug(\"Remarking entire document...\")\n    await Styler.ProcessDocument()\n  }\n\n  saveSettings = () => {\n    console.debug(\"Saving settings...\")\n    const settings = this.state.settings.toJS()\n    const profile = this.state.profile.toJS()\n    console.debug(\"Settings: \", settings, \"Profile: \", profile)\n    Office.context.document.settings.set(\"settings\", settings)\n    Office.context.document.settings.set(\"profile\", profile)\n    Office.context.document.settings.saveAsync(result => {\n      console.info(\"Settings saved: \", result)\n    })\n  }\n\n  resetSettings = () => {\n    console.debug(\"Reseting settings...\")\n    this.setState(\n      {\n        settings: SettingsRecord(),\n        profile: ProfileRecord(),\n      },\n      this.saveSettings\n    )\n  }\n\n  dismissGetStarted = async (insert?: boolean) => {\n    console.debug(\"Dismissing GetStarted ...\")\n    this.setState(\n      state => ({\n        profile: state.profile.set(\"showGetStarted\", false),\n      }),\n      this.saveSettings\n    )\n    if (insert) {\n      await this.insertReadme()\n    }\n  }\n\n  dismissMessage = async messageId => {\n    console.debug(\"Dismissing message: \", messageId)\n    this.setState(\n      state => ({\n        profile: state.profile.set(\n          \"showMessages\",\n          state.profile.get(\"showMessages\").set(messageId, false)\n        ),\n      }),\n      this.saveSettings\n    )\n  }\n\n  mergeSettings = async (partialSettings: Partial<SettingsType>) => {\n    console.info(\"Merging settings: \", partialSettings)\n    this.setState(\n      { settings: this.state.settings.merge(partialSettings) },\n      this.saveSettings\n    )\n  }\n\n  render() {\n    if (!this.props.isOfficeInitialized) {\n      return (\n        <Progress\n          title={this.props.title}\n          logo=\"assets/logo-filled.png\"\n          message=\"Make Word a markdown friendly collaborative editor\"\n        />\n      )\n    }\n\n    return (\n      <div className=\"ms-welcome\">\n        <HeroList\n          message=\"Make Word a markdown friendly collaborative editor\"\n          items={[]}\n        ></HeroList>\n        <main className=\"ms-Grid\" dir=\"ltr\">\n          <Fabric.Stack>\n            {this.state.messages.map(\n              message =>\n                this.state.profile.get(\"showMessages\").get(message.get(\"id\")) !=\n                  false && (\n                  <Fabric.StackItem key={message.get(\"id\")}>\n                    <Fabric.MessageBar\n                      messageBarType={message.get(\"type\")}\n                      onDismiss={\n                        message.get(\"isDismissable\")\n                          ? () => this.dismissMessage(message.get(\"id\"))\n                          : undefined\n                      }\n                    >\n                      {message.get(\"content\")}\n                    </Fabric.MessageBar>\n                  </Fabric.StackItem>\n                )\n            )}\n          </Fabric.Stack>\n          <Fabric.Separator># Home</Fabric.Separator>\n          <div className=\"ms-Grid-row\">\n            {DEBUG && (\n              <ElementContainer>\n                <Fabric.DefaultButton\n                  style={ButtonStyle}\n                  iconProps={{ iconName: \"ChevronRight\" }}\n                  onClick={this.clickDevButton}\n                >\n                  Dev Button\n                </Fabric.DefaultButton>\n              </ElementContainer>\n            )}\n            <ElementContainer>\n              <span ref={span => (this.GetStartedSpan = span)}>\n                <Fabric.DefaultButton\n                  style={ButtonStyle}\n                  iconProps={{ iconName: \"MarkDownLanguage\" }}\n                  onClick={this.insertReadme}\n                >\n                  Insert Readme.md\n                </Fabric.DefaultButton>\n              </span>\n              {this.state.profile.get(\"showGetStarted\") && (\n                <Fabric.TeachingBubble\n                  target={this.GetStartedSpan}\n                  primaryButtonProps={{\n                    children: \"Go ahead\",\n                    onClick: () => this.dismissGetStarted(true),\n                  }}\n                  secondaryButtonProps={{\n                    children: \"Later\",\n                    onClick: () => this.dismissGetStarted(),\n                  }}\n                  headline=\"Get Started\"\n                  onDismiss={() => this.dismissGetStarted()}\n                >\n                  Insert Readme.md to the top of your document\n                </Fabric.TeachingBubble>\n              )}\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.DefaultButton\n                style={ButtonStyle}\n                iconProps={{ iconName: \"Color\" }}\n                onClick={this.setupTheme}\n              >\n                Setup Theme\n              </Fabric.DefaultButton>\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.DefaultButton\n                style={ButtonStyle}\n                iconProps={{ iconName: \"ChevronDown\" }}\n                onClick={this.remarkSelection}\n              >\n                Remark Selection\n              </Fabric.DefaultButton>\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.DefaultButton\n                style={ButtonStyle}\n                iconProps={{ iconName: \"ChevronDownEnd6\" }}\n                onClick={this.remarkDocument}\n              >\n                Remark Document\n              </Fabric.DefaultButton>\n            </ElementContainer>\n          </div>\n          <Fabric.Separator># Settings</Fabric.Separator>\n          <div className=\"ms-Grid-row\">\n            <ElementContainer>\n              <Fabric.Toggle\n                checked={this.state.settings.get(\"enableStyler\")}\n                label=\"Enable Styler\"\n                inlineLabel={true}\n                onChange={(_, checked) => {\n                  this.mergeSettings({ enableStyler: checked })\n                }}\n              />\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.Toggle\n                checked={this.state.settings.get(\"inlineStyle\")}\n                label=\"Styler: Inline Style\"\n                inlineLabel={true}\n                onChange={(_, checked) => {\n                  this.mergeSettings({ inlineStyle: checked })\n                }}\n              />\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.Toggle\n                checked={this.state.settings.get(\"enablePrettier\")}\n                label=\"Enable Prettier\"\n                inlineLabel={true}\n                onChange={(_, checked) => {\n                  this.mergeSettings({ enablePrettier: checked })\n                }}\n              />\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.Toggle\n                checked={this.state.settings.get(\"proseWrap\")}\n                label=\"Prettier: Prose Wrap\"\n                inlineLabel={true}\n                onChange={(_, checked) => {\n                  this.mergeSettings({ proseWrap: checked })\n                }}\n              />\n            </ElementContainer>\n            <ElementContainer>\n              <Fabric.DefaultButton\n                style={ButtonStyle}\n                iconProps={{ iconName: \"ChevronDownEnd6\" }}\n                onClick={this.resetSettings}\n              >\n                Reset Settings\n              </Fabric.DefaultButton>\n            </ElementContainer>\n          </div>\n        </main>\n      </div>\n    )\n  }\n}\n","import * as React from \"react\"\n\nexport interface HeroListItem {\n  icon: string\n  primaryText: string\n}\n\nexport interface HeroListProps {\n  message: string\n  items: HeroListItem[]\n}\n\nexport default class HeroList extends React.Component<HeroListProps> {\n  render() {\n    const { children, items, message } = this.props\n\n    const listItems = items.map((item, index) => (\n      <li className=\"ms-ListItem\" key={index}>\n        <i className={`ms-Icon ms-Icon--${item.icon}`} />\n        <span className=\"ms-font-m ms-fontColor-neutralPrimary\">\n          {item.primaryText}\n        </span>\n      </li>\n    ))\n    return (\n      <header className=\"ms-welcome__main\">\n        <h2 className=\"ms-font-xl ms-fontWeight-semilight ms-fontColor-neutralPrimary ms-u-slideUpIn20\">\n          {message}\n        </h2>\n        <ul className=\"ms-List ms-welcome__features ms-u-slideUpIn10\">\n          {listItems}\n        </ul>\n        {children}\n      </header>\n    )\n  }\n}\n","import * as React from \"react\"\nimport { Spinner, SpinnerType } from \"office-ui-fabric-react\"\n\nexport interface ProgressProps {\n  logo: string\n  message: string\n  title: string\n}\n\nexport default class Progress extends React.Component<ProgressProps> {\n  render() {\n    const { logo, message, title } = this.props\n\n    return (\n      <section className=\"ms-welcome__progress ms-u-fadeIn500\">\n        <img width=\"90\" height=\"90\" src={logo} alt={title} title={title} />\n        <h1 className=\"ms-fontSize-su ms-fontWeight-light ms-fontColor-neutralPrimary\">\n          {title}\n        </h1>\n        <Spinner type={SpinnerType.large} label={message} />\n      </section>\n    )\n  }\n}\n","export default \"---\\ntitle: Markdown Styler for MS Word\\nauthor: poifuture\\n---\\n\\n<!-- prettier-ignore-start -->\\n<!-- markdownlint-disable -->\\n<!-- DO NOT FORMAT. This file is used to teach people how to use prettier in MS Word, so we keep exactly whatever it looks. -->\\n\\n# Markdown Styler for MS Word\\n\\n> Make MS Word a markdown friendly collaborative editor.\\n\\nWelcome to markdown world!\\nThis MS Word add-in aims to apply MS Word styles to your document without changing your markdown content.\\nYou can easily view your document with a better style while collaborating with others on the document.\\nOur team is actively using it for writing our meeting notes.\\n\\n<!-- INSTALL SECTION BEGIN  -->\\n\\n## Install\\n\\nOpen MS Word Online -> Insert -> Office Add-ins -> Store -> Search \\\"Markdown Styler\\\" -> Add\\n\\n<!-- INSTALL SECTION END -->\\n\\n## Usage\\n\\n1. Insert Readme and read the warning\\n1. (Optional) Setup the document theme\\n1. Click \\\"Remark Document\\\"\\n1. (Optional) Customize the built-in styles (Normal, Heading1, etc.) of the document theme in MS Word\\n\\n## Warning\\n\\nIf any content is missing, try the \\\"History\\\" feature of MS Word. (Open folder in OneDrive Online -> Right click the file -> Version history)\\n\\n## Why MS Word (Online)\\n\\n* Good integration with MS products family and **Office Enterprise accounts**\\n* More acceptable by tradition companys\\n* Real time collaborative editing (buggy but usable)\\n* Version history (extremely buggy comparing to ...)\\n* China friendly\\n* Free! (For personal use) (From developer: We paid Office 365!)\\n* ~~Rich functionality~~ Rich bugs\\n\\n## What it does\\n\\n1. Clear all pre-existing styles\\n1. Format your document with [Prettier](https://github.com/prettier/prettier)\\n   1. Prettier will format your markdown\\n   1. [Not Implemented] Prettier will format your front matter\\n   1. [Not Implemented] Prettier will format your code block\\n1. Parse your markdown styles with [Remark](https://github.com/remarkjs/remark)\\n1. [Not Implemented] Apply syntax highlights to your code block with [Highlight.js](https://github.com/highlightjs/highlight.js/)\\n1. [Not Implemented] Watch live changes and apply style after typing Enter\\n\\n## What setup does\\n\\n* [Not Implemented] Change the theme font of your document\\n  - Face: Courier New (A monospace font)\\n  - Size: 10 (To make each line contains >=80 chars)\\n\\n## Examples\\n\\n### Long Paragraph\\n\\nA long paragraph will be rewrapped at column 80 if the `prettier.proseWrap` is configured as `always`.\\nIf there is no empty line, the two lines will be merged in markdown.\\nSo please always remember to insert an empty line between your paragraphs.\\n\\n### Headings\\n\\n### A **Strong** Title\\n\\nThere is a **strong** word and **some phrases** in a sentence.\\n\\n### List\\n\\n### Table\\n\\nColumn 1 | Column 2 has a long head | c3 | c4\\n--- | --- | --- | ---\\nc1 | c2 | Column 3 is long | c4\\n\\n### Code\\n\\n```javascript\\n  const a=1\\n```\\n\\n## Known Issues\\n\\n### Inline Style\\n\\nThe inline style doesn't work at all in both Word Online and Word Desktop because of different Microsoft issues. In Word Online (Chrome), the inline style will sometimes apply to the entire paragraph after the targeted range. See [bug](https://github.com/OfficeDev/office-js/issues/586). In on-premise Word (Word Desktop), the javascript engine is IE, which lacks the functionality of choosing the exact range.\\n\\n### Whitespcaces\\n\\nAs every web UI developer knows, a normal space (0x20, ascii 32) is different from a display space (0xA0, ascii 160, also known as nbsp, non-breaking space, hard space, etc.). As a workaround, this Add-in will replace all nbsp to space before processing, and put nbsp back in document. It works fine for most cases. However, in rare scenarios, you may accidentally get nbsp in your document. So... be careful.\\n\\n### MS Word doesn't have a vim plugin\\n\\nSo sad...\\n\\n## FAQ\\n\\n> When will \\\"not implemented\\\" become \\\"implemented\\\"?\\n\\nWhen we get 100 [github stars](https://github.com/poifuture/word-add-in-markdown-style)\\n\\n> When will Google doc come true?\\n\\nIf we get can an average rating over 4/5.\\n\\n> Alternatives?\\n\\nTry [SlackEdit](https://stackedit.io/) if you prefer independent app!\\n\\n## Appreciation\\n\\nThis tool can't be real without the awesome work of [Remark](https://github.com/remarkjs/remark), [Prettier](https://github.com/prettier/prettier) and [MSOffice](https://github.com/OfficeDev/office-js)\\n\\n## Contributing?\\n\\nWarm Welcome!\\n\\n<!-- prettier-ignore-end -->\\n\"","// A wrapper to declare global var\ndeclare var DEBUG: boolean\nexport default typeof DEBUG === \"boolean\" ? DEBUG : true\n","import * as React from \"react\"\nimport \"office-ui-fabric-react/dist/css/fabric.min.css\"\nimport { initializeIcons } from \"office-ui-fabric-react/lib/Icons\"\nimport { Customizer } from \"office-ui-fabric-react\"\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\"\nimport App, { AppPropsType } from \"./components/App\"\n\ninitializeIcons()\n\nexport interface BootstrapPropsType extends AppPropsType {\n  app: typeof App\n}\n\nexport class Bootstrap extends React.Component<BootstrapPropsType> {\n  static defaultProps = {\n    app: App,\n  }\n  render() {\n    const Component = this.props.app\n    return (\n      <Customizer {...FluentCustomizations}>\n        <Component {...this.props} />\n      </Customizer>\n    )\n  }\n}\n","import Unified, * as UnifiedModule from \"unified\"\nimport * as Unist from \"unist\"\nimport RemarkFrontmatter from \"remark-frontmatter\"\nimport RemarkParse from \"remark-parse\"\nimport Prettier from \"prettier/standalone\"\nimport PrettierMarkdown from \"prettier/parser-markdown\"\nimport { hex } from \"./utils\"\n\nconst DEFAULT_SETTINGS = {\n  enableStyler: true,\n  inlineStyle: true,\n  enablePrettier: true,\n  proseWrap: false,\n}\n\nconst getCleanText = (str: string): string =>\n  str\n    .replace(/(?:\\r\\n|\\r|\\n)/g, \"\\n\") // crlf\n    .replace(/\\xA0/g, \" \") // &nbsp;\n\nconst getDisplayText = (str: string): string =>\n  str.replace(/[ ]{2,}/g, (match: String) => \"\\xA0\".repeat(match.length)) // &nbsp;\n\nconst loadSettings = async () => {\n  console.debug(\"Loading addin settings...\")\n  const loadSettingsPromise = new Promise((resolve, reject) => {\n    Office.context.document.settings.refreshAsync(result => {\n      console.debug(\"Loaded addin settings result: \", result)\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        reject(result.error)\n      }\n      resolve()\n    })\n  })\n  await loadSettingsPromise\n  const settings = Office.context.document.settings.get(\"settings\")\n  const profile = Office.context.document.settings.get(\"profile\")\n  console.info(\"Loaded Settings: \", settings, \"Profile: \", profile)\n  if (!settings) {\n    // Frist time startup\n    Office.context.document.settings.set(\"settings\", DEFAULT_SETTINGS)\n    return DEFAULT_SETTINGS\n  }\n  return settings\n}\n\nconst getPointParagraph = async (\n  range: Word.Range,\n  point: Unist.Point\n): Promise<Word.Paragraph> => {\n  console.debug(\"Geting point paragraph... \", point)\n  range.paragraphs.load(\"items\")\n  await range.paragraphs.context.sync()\n  console.debug(\"Got paragraph: \", range.paragraphs.items[point.line - 1])\n  return range.paragraphs.items[point.line - 1]\n}\n\nconst getPointCursur = async (\n  range: Word.Range,\n  point: Unist.Point,\n  options: { isEnd: boolean }\n): Promise<Word.Range> => {\n  console.debug(\"Getting point cursor... \", point)\n  const pointParagraph = await getPointParagraph(range, point)\n  const charRanges = pointParagraph.split([\"\"])\n  charRanges.load(\"items\")\n  await charRanges.context.sync()\n  console.debug(\"Got paragraph char cursors: \", charRanges)\n  const pointCursor = options.isEnd\n    ? charRanges.items[point.column - 2]\n    : charRanges.items[point.column - 1]\n  return pointCursor\n}\n\nconst getNodeRange = async (\n  range: Word.Range,\n  node: Unist.Node\n): Promise<Word.Range> => {\n  const startParagraph = await getPointParagraph(range, node.position.start)\n  const startCharRanges = startParagraph.split([\"\"])\n  startCharRanges.load(\"items\")\n  await startCharRanges.context.sync()\n  const startCursor = startCharRanges.items[node.position.start.column - 1]\n  const endCursor =\n    node.position.start.line == node.position.end.line\n      ? startCharRanges.items[node.position.end.column - 2]\n      : await getPointCursur(range, node.position.end, { isEnd: true })\n  const nodeRange = startCursor.expandTo(\n    endCursor.getRange(Word.RangeLocation.after)\n  )\n  return nodeRange\n}\n\nconst expandToParagraph = (range: Word.Range): Word.Range => {\n  const startCursor = range.paragraphs\n    .getFirst()\n    .getRange(Word.RangeLocation.start)\n  const endCursor = range.paragraphs.getLast().getRange(Word.RangeLocation.end)\n  return range.expandTo(startCursor).expandTo(endCursor)\n}\n\ninterface UnistParentNode extends Unist.Node {\n  children?: Unist.Node[]\n}\ntype VisitorFunction = (node: Unist.Node) => Promise<void>\nconst UnistDFS = async (node: Unist.Node, visitor: VisitorFunction) => {\n  await visitor(node)\n  const extendedNode = node as UnistParentNode\n  if (extendedNode.children) {\n    for (let index = 0; index < extendedNode.children.length; index++) {\n      await UnistDFS(extendedNode.children[index], visitor)\n    }\n  }\n}\n\nconst RemarkWord: UnifiedModule.Attacher = function(options: {\n  // Cant use arrow function here because the context of 'this' will be different\n  range: Word.Range\n  inlineStyle?: boolean\n}) {\n  const range = options.range\n  const inlineStyle = options.inlineStyle ? true : false // strip undefined\n  const RemarkWordTransformer: UnifiedModule.Transformer = async (\n    tree,\n    _\n  ): Promise<Unist.Node> => {\n    console.debug(\"Tree: \", tree)\n    range.paragraphs.load()\n    await range.context.sync()\n    // Note: Don't try to apply styles in a parallel way. Will face unpredictable behavior!\n    await UnistDFS(tree, async (node: Unist.Node) => {\n      console.debug(\"Node: \", node)\n      switch (node.type) {\n        case \"yaml\": {\n          const nodeRange = await getNodeRange(range, node)\n          nodeRange.font.color = \"darkblue\"\n          await nodeRange.context.sync()\n          const titleParagraph = nodeRange\n            .search(\"title:\")\n            .getFirst()\n            .paragraphs.getFirst()\n          titleParagraph.styleBuiltIn = Word.Style.title\n          await titleParagraph.context.sync()\n          break\n        }\n        case \"heading\": {\n          const nodeHeading: any = node\n          const WordHeadingStyles = [\n            Word.Style.title,\n            Word.Style.heading1,\n            Word.Style.heading2,\n            Word.Style.heading3,\n            Word.Style.heading4,\n            Word.Style.heading5,\n            Word.Style.heading6,\n            Word.Style.heading7,\n            Word.Style.heading8,\n            Word.Style.heading9,\n          ]\n          const nodeParagraph = await getPointParagraph(\n            range,\n            node.position.start\n          )\n          nodeParagraph.styleBuiltIn = WordHeadingStyles[nodeHeading.depth]\n          break\n        }\n        case \"strong\": {\n          if (!inlineStyle) {\n            break\n          }\n          const nodeRange = await getNodeRange(range, node)\n          nodeRange.styleBuiltIn = Word.Style.strong\n          nodeRange.font.color = \"darkblue\"\n          break\n        }\n      }\n    })\n    return tree\n  }\n  this.Compiler = tree => {\n    console.debug(\"Compiler Tree:\", tree)\n    return \"\"\n  }\n  return RemarkWordTransformer\n}\n\nconst ProcessStyler = async (\n  range: Word.Range,\n  options: { inlineStyle?: boolean } = {}\n) => {\n  await Word.run(async () => {\n    console.debug(\"Parsing markdown document...\")\n    range.load()\n    await range.context.sync()\n    const remarkText = getCleanText(range.text)\n    const remarkPromise = new Promise((resolve, reject) => {\n      Unified()\n        .use(RemarkParse)\n        .use(RemarkFrontmatter, [\"yaml\", \"toml\"])\n        .use(RemarkWord, { range: range, inlineStyle: options.inlineStyle })\n        .process(remarkText, (error, _) => {\n          if (error) {\n            reject(error)\n          }\n          resolve(\"\")\n        })\n    })\n    await remarkPromise\n    console.info(\"Walking through done.\")\n    await range.context.sync()\n  })\n  console.info(\"Styler process done.\")\n}\nconst ProcessPrettier = async (\n  range: Word.Range,\n  options: { proseWrap?: boolean } = {}\n) => {\n  await Word.run(async () => {\n    console.debug(\"Fetching document content...\")\n    range.load()\n    await range.context.sync()\n    const originalText = getCleanText(range.text)\n    if (originalText == \"\") {\n      console.error(\"No text is selected\")\n      return\n    }\n    console.info(\"Original Text: \", originalText, await hex(originalText))\n\n    console.debug(\"Prettifying markdown document...\")\n    const prettyText: string = Prettier.format(originalText, {\n      parser: \"markdown\",\n      plugins: [PrettierMarkdown],\n      proseWrap: options.proseWrap ? \"always\" : \"never\", // [always,never,preserve]\n    })\n    console.info(\"Pretty Text: \", prettyText, await hex(prettyText))\n\n    let fixedText = prettyText\n    if (originalText.startsWith(\"\\n\") && !fixedText.startsWith(\"\\n\")) {\n      fixedText = \"\\n\" + fixedText\n    }\n    if (!originalText.endsWith(\"\\n\") && fixedText.endsWith(\"\\n\")) {\n      fixedText = fixedText.slice(0, -1)\n    }\n    console.debug(\"Fixed Text: \", fixedText)\n\n    console.debug(\"Replacing prettier document...\")\n    range.insertText(getDisplayText(fixedText), Word.InsertLocation.replace)\n    await range.context.sync()\n  })\n  console.info(\"Prettier process done.\")\n}\n\nconst ProcessRange = async (range: Word.Range) => {\n  const settings = await loadSettings()\n  await Word.run(async () => {\n    console.debug(\"Reseting style ...\")\n    range.styleBuiltIn = Word.Style.normal\n    await range.context.sync()\n  })\n  if (settings.enablePrettier) {\n    await ProcessPrettier(range, { proseWrap: settings.proseWrap })\n  }\n  if (settings.enableStyler) {\n    await ProcessStyler(range, { inlineStyle: settings.inlineStyle })\n  }\n  console.info(\"All processes done.\")\n}\n\nexport const ProcessSelection = async () => {\n  try {\n    let remarkRange: Word.Range = undefined\n    await Word.run(async context => {\n      console.debug(\"Getting selection range...\")\n      const inputRange = expandToParagraph(context.document.getSelection())\n      remarkRange = inputRange\n      context.trackedObjects.add(remarkRange)\n      await context.sync()\n    })\n    await ProcessRange(remarkRange)\n  } catch (error) {\n    console.error(error)\n  }\n}\nexport const ProcessDocument = async () => {\n  try {\n    let remarkRange: Word.Range = undefined\n    await Word.run(async context => {\n      console.debug(\"Getting document range...\")\n      const inputRange = context.document.body.getRange()\n      remarkRange = inputRange\n      context.trackedObjects.add(remarkRange)\n      await context.sync()\n    })\n    await ProcessRange(remarkRange)\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nexport default {\n  ProcessSelection: ProcessSelection,\n  ProcessDocument: ProcessDocument,\n}\n","type HexFunction = (str: String) => Promise<Array<number>>\nexport const hex: HexFunction = async str =>\n  str.split(\"\").map(ch => ch.charCodeAt(0))\n\ntype SleepFunction = (ms: number) => Promise<void>\nexport const sleep: SleepFunction = ms => {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n"],"sourceRoot":""}