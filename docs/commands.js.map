{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/core/styler.ts","webpack:///./src/core/utils.ts","webpack:///./src/commands/commands.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","DEFAULT_SETTINGS","enableStyler","inlineStyle","enablePrettier","proseWrap","getCleanText","str","replace","getPointParagraph","range","point","__awaiter","undefined","paragraphs","load","context","sync","_a","sent","items","line","getPointCursur","options","pointParagraph","charRanges","split","isEnd","column","getNodeRange","node","position","start","startParagraph","_b","startCharRanges","startCursor","end","endCursor","expandTo","getRange","Word","RangeLocation","after","UnistDFS","visitor","extendedNode","children","index","RemarkWord","_this","this","Compiler","tree","_","type","nodeRange","font","color","titleParagraph","search","getFirst","styleBuiltIn","Style","title","nodeHeading","WordHeadingStyles","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","depth","strong","ProcessStyler","run","remarkText","text","Promise","resolve","reject","unified__WEBPACK_IMPORTED_MODULE_0___default","use","remark_parse__WEBPACK_IMPORTED_MODULE_2___default","a","remark_frontmatter__WEBPACK_IMPORTED_MODULE_1___default","process","error","ProcessPrettier","_g","originalText","console","info","_utils__WEBPACK_IMPORTED_MODULE_5__","_c","concat","prettyText","prettier_standalone__WEBPACK_IMPORTED_MODULE_3___default","format","parser","plugins","prettier_parser_markdown__WEBPACK_IMPORTED_MODULE_4___default","_e","_d","_f","fixedText","startsWith","endsWith","insertText","match","repeat","InsertLocation","ProcessRange","Office","document","settings","refreshAsync","status","AsyncResultStatus","Succeeded","set","normal","__webpack_exports__","ProcessSelection","remarkRange_1","getSelection","getLast","inputRange","trackedObjects","add","error_1","ProcessDocument","remarkRange_2","body","error_2","hex","__generator","map","ch","charCodeAt","global","_core_styler__WEBPACK_IMPORTED_MODULE_2__","onReady","g","self","onClickRemarkSelection","event","finally","completed","onClickRemarkDocument"],"mappings":"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","file":"commands.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([597,0,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import Unified, * as UnifiedModule from \"unified\"\nimport * as Unist from \"unist\"\nimport RemarkFrontmatter from \"remark-frontmatter\"\nimport RemarkParse from \"remark-parse\"\nimport Prettier from \"prettier/standalone\"\nimport PrettierMarkdown from \"prettier/parser-markdown\"\nimport { hex } from \"./utils\"\n\nconst DEFAULT_SETTINGS = {\n  enableStyler: true,\n  inlineStyle: true,\n  enablePrettier: true,\n  proseWrap: false,\n}\n\nconst getCleanText = (str: string): string =>\n  str\n    .replace(/(?:\\r\\n|\\r|\\n)/g, \"\\n\") // crlf\n    .replace(/\\xA0/g, \" \") // &nbsp;\n\nconst getDisplayText = (str: string): string =>\n  str.replace(/[ ]{2,}/g, (match: String) => \"\\xA0\".repeat(match.length)) // &nbsp;\n\nconst loadSettings = async () => {\n  console.debug(\"Loading addin settings...\")\n  const loadSettingsPromise = new Promise((resolve, reject) => {\n    Office.context.document.settings.refreshAsync(result => {\n      console.debug(\"Loaded addin settings result: \", result)\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        reject(result.error)\n      }\n      resolve()\n    })\n  })\n  await loadSettingsPromise\n  const settings = Office.context.document.settings.get(\"settings\")\n  const profile = Office.context.document.settings.get(\"profile\")\n  console.info(\"Loaded Settings: \", settings, \"Profile: \", profile)\n  if (!settings) {\n    // Frist time startup\n    Office.context.document.settings.set(\"settings\", DEFAULT_SETTINGS)\n    return DEFAULT_SETTINGS\n  }\n  return settings\n}\n\nconst getPointParagraph = async (\n  range: Word.Range,\n  point: Unist.Point\n): Promise<Word.Paragraph> => {\n  console.debug(\"Geting point paragraph... \", point)\n  range.paragraphs.load(\"items\")\n  await range.paragraphs.context.sync()\n  console.debug(\"Got paragraph: \", range.paragraphs.items[point.line - 1])\n  return range.paragraphs.items[point.line - 1]\n}\n\nconst getPointCursur = async (\n  range: Word.Range,\n  point: Unist.Point,\n  options: { isEnd: boolean }\n): Promise<Word.Range> => {\n  console.debug(\"Getting point cursor... \", point)\n  const pointParagraph = await getPointParagraph(range, point)\n  const charRanges = pointParagraph.split([\"\"])\n  charRanges.load(\"items\")\n  await charRanges.context.sync()\n  console.debug(\"Got paragraph char cursors: \", charRanges)\n  const pointCursor = options.isEnd\n    ? charRanges.items[point.column - 2]\n    : charRanges.items[point.column - 1]\n  return pointCursor\n}\n\nconst getNodeRange = async (\n  range: Word.Range,\n  node: Unist.Node\n): Promise<Word.Range> => {\n  const startParagraph = await getPointParagraph(range, node.position.start)\n  const startCharRanges = startParagraph.split([\"\"])\n  startCharRanges.load(\"items\")\n  await startCharRanges.context.sync()\n  const startCursor = startCharRanges.items[node.position.start.column - 1]\n  const endCursor =\n    node.position.start.line == node.position.end.line\n      ? startCharRanges.items[node.position.end.column - 2]\n      : await getPointCursur(range, node.position.end, { isEnd: true })\n  const nodeRange = startCursor.expandTo(\n    endCursor.getRange(Word.RangeLocation.after)\n  )\n  return nodeRange\n}\n\nconst expandToParagraph = (range: Word.Range): Word.Range => {\n  const startCursor = range.paragraphs\n    .getFirst()\n    .getRange(Word.RangeLocation.start)\n  const endCursor = range.paragraphs.getLast().getRange(Word.RangeLocation.end)\n  return range.expandTo(startCursor).expandTo(endCursor)\n}\n\ninterface UnistParentNode extends Unist.Node {\n  children?: Unist.Node[]\n}\ntype VisitorFunction = (node: Unist.Node) => Promise<void>\nconst UnistDFS = async (node: Unist.Node, visitor: VisitorFunction) => {\n  await visitor(node)\n  const extendedNode = node as UnistParentNode\n  if (extendedNode.children) {\n    for (let index = 0; index < extendedNode.children.length; index++) {\n      await UnistDFS(extendedNode.children[index], visitor)\n    }\n  }\n}\n\nconst RemarkWord: UnifiedModule.Attacher = function(options: {\n  // Cant use arrow function here because the context of 'this' will be different\n  range: Word.Range\n  inlineStyle?: boolean\n}) {\n  const range = options.range\n  const inlineStyle = options.inlineStyle ? true : false // strip undefined\n  const RemarkWordTransformer: UnifiedModule.Transformer = async (\n    tree,\n    _\n  ): Promise<Unist.Node> => {\n    console.debug(\"Tree: \", tree)\n    range.paragraphs.load()\n    await range.context.sync()\n    // Note: Don't try to apply styles in a parallel way. Will face unpredictable behavior!\n    await UnistDFS(tree, async (node: Unist.Node) => {\n      console.debug(\"Node: \", node)\n      switch (node.type) {\n        case \"yaml\": {\n          const nodeRange = await getNodeRange(range, node)\n          nodeRange.font.color = \"darkblue\"\n          await nodeRange.context.sync()\n          const titleParagraph = nodeRange\n            .search(\"title:\")\n            .getFirst()\n            .paragraphs.getFirst()\n          titleParagraph.styleBuiltIn = Word.Style.title\n          await titleParagraph.context.sync()\n          break\n        }\n        case \"heading\": {\n          const nodeHeading: any = node\n          const WordHeadingStyles = [\n            Word.Style.title,\n            Word.Style.heading1,\n            Word.Style.heading2,\n            Word.Style.heading3,\n            Word.Style.heading4,\n            Word.Style.heading5,\n            Word.Style.heading6,\n            Word.Style.heading7,\n            Word.Style.heading8,\n            Word.Style.heading9,\n          ]\n          const nodeParagraph = await getPointParagraph(\n            range,\n            node.position.start\n          )\n          nodeParagraph.styleBuiltIn = WordHeadingStyles[nodeHeading.depth]\n          break\n        }\n        case \"strong\": {\n          if (!inlineStyle) {\n            break\n          }\n          const nodeRange = await getNodeRange(range, node)\n          nodeRange.styleBuiltIn = Word.Style.strong\n          nodeRange.font.color = \"darkblue\"\n          break\n        }\n      }\n    })\n    return tree\n  }\n  this.Compiler = tree => {\n    console.debug(\"Compiler Tree:\", tree)\n    return \"\"\n  }\n  return RemarkWordTransformer\n}\n\nconst ProcessStyler = async (\n  range: Word.Range,\n  options: { inlineStyle?: boolean } = {}\n) => {\n  await Word.run(async () => {\n    console.debug(\"Parsing markdown document...\")\n    range.load()\n    await range.context.sync()\n    const remarkText = getCleanText(range.text)\n    const remarkPromise = new Promise((resolve, reject) => {\n      Unified()\n        .use(RemarkParse)\n        .use(RemarkFrontmatter, [\"yaml\", \"toml\"])\n        .use(RemarkWord, { range: range, inlineStyle: options.inlineStyle })\n        .process(remarkText, (error, _) => {\n          if (error) {\n            reject(error)\n          }\n          resolve(\"\")\n        })\n    })\n    await remarkPromise\n    console.info(\"Walking through done.\")\n    await range.context.sync()\n  })\n  console.info(\"Styler process done.\")\n}\nconst ProcessPrettier = async (\n  range: Word.Range,\n  options: { proseWrap?: boolean } = {}\n) => {\n  await Word.run(async () => {\n    console.debug(\"Fetching document content...\")\n    range.load()\n    await range.context.sync()\n    const originalText = getCleanText(range.text)\n    if (originalText == \"\") {\n      console.error(\"No text is selected\")\n      return\n    }\n    console.info(\"Original Text: \", originalText, await hex(originalText))\n\n    console.debug(\"Prettifying markdown document...\")\n    const prettyText: string = Prettier.format(originalText, {\n      parser: \"markdown\",\n      plugins: [PrettierMarkdown],\n      proseWrap: options.proseWrap ? \"always\" : \"never\", // [always,never,preserve]\n    })\n    console.info(\"Pretty Text: \", prettyText, await hex(prettyText))\n\n    let fixedText = prettyText\n    if (originalText.startsWith(\"\\n\") && !fixedText.startsWith(\"\\n\")) {\n      fixedText = \"\\n\" + fixedText\n    }\n    if (!originalText.endsWith(\"\\n\") && fixedText.endsWith(\"\\n\")) {\n      fixedText = fixedText.slice(0, -1)\n    }\n    console.debug(\"Fixed Text: \", fixedText)\n\n    console.debug(\"Replacing prettier document...\")\n    range.insertText(getDisplayText(fixedText), Word.InsertLocation.replace)\n    await range.context.sync()\n  })\n  console.info(\"Prettier process done.\")\n}\n\nconst ProcessRange = async (range: Word.Range) => {\n  const settings = await loadSettings()\n  await Word.run(async () => {\n    console.debug(\"Reseting style ...\")\n    range.styleBuiltIn = Word.Style.normal\n    await range.context.sync()\n  })\n  if (settings.enablePrettier) {\n    await ProcessPrettier(range, { proseWrap: settings.proseWrap })\n  }\n  if (settings.enableStyler) {\n    await ProcessStyler(range, { inlineStyle: settings.inlineStyle })\n  }\n  console.info(\"All processes done.\")\n}\n\nexport const ProcessSelection = async () => {\n  try {\n    let remarkRange: Word.Range = undefined\n    await Word.run(async context => {\n      console.debug(\"Getting selection range...\")\n      const inputRange = expandToParagraph(context.document.getSelection())\n      remarkRange = inputRange\n      context.trackedObjects.add(remarkRange)\n      await context.sync()\n    })\n    await ProcessRange(remarkRange)\n  } catch (error) {\n    console.error(error)\n  }\n}\nexport const ProcessDocument = async () => {\n  try {\n    let remarkRange: Word.Range = undefined\n    await Word.run(async context => {\n      console.debug(\"Getting document range...\")\n      const inputRange = context.document.body.getRange()\n      remarkRange = inputRange\n      context.trackedObjects.add(remarkRange)\n      await context.sync()\n    })\n    await ProcessRange(remarkRange)\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nexport default {\n  ProcessSelection: ProcessSelection,\n  ProcessDocument: ProcessDocument,\n}\n","type HexFunction = (str: String) => Promise<Array<number>>\nexport const hex: HexFunction = async str =>\n  str.split(\"\").map(ch => ch.charCodeAt(0))\n\ntype SleepFunction = (ms: number) => Promise<void>\nexport const sleep: SleepFunction = ms => {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n","import \"core-js/stable\" // polyfill\nimport \"regenerator-runtime/runtime\" // polyfill\nimport Styler from \"../core/styler\"\n\nOffice.onReady(() => {})\n\nfunction getGlobal() {\n  return typeof self !== \"undefined\"\n    ? self\n    : typeof window !== \"undefined\"\n    ? window\n    : typeof global !== \"undefined\"\n    ? global\n    : undefined\n}\n\nconst g = getGlobal() as any\n\ng.onClickRemarkSelection = (event: Office.AddinCommands.Event) => {\n  console.debug(\"[Ribbon] Remarking selection...\", event)\n  Styler.ProcessSelection().finally(() => {\n    event.completed()\n  })\n}\n\ng.onClickRemarkDocument = (event: Office.AddinCommands.Event) => {\n  console.debug(\"[Ribbon] Remarking document...\", event)\n  Styler.ProcessDocument().finally(() => {\n    event.completed()\n  })\n}\n"],"sourceRoot":""}